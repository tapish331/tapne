{% extends "base.html" %}

{% block title %}tapne | Search{% endblock %}

{% block content %}
<section class="hero hero-compact">
    <p class="eyebrow">Search</p>
    <h1>Discover trips, users, and blogs.</h1>
    {% if user.is_authenticated %}
    <p>Default suggestions should come from like-minded member behavior.</p>
    {% else %}
    <p>Default suggestions should come from global traffic and search demand.</p>
    {% endif %}
</section>

{% with selected_type=active_type|default:"all" %}
<form class="search-form" method="get" action="/search/">
    <label for="q">Search</label>
    <input id="q" name="q" type="search" placeholder="Try Bali, @host, or food guide..." value="{{ search_query|default:'' }}">

    <label for="type">Type</label>
    <select id="type" name="type">
        <option value="all" {% if selected_type == "all" %}selected{% endif %}>All</option>
        <option value="trips" {% if selected_type == "trips" %}selected{% endif %}>Trips</option>
        <option value="users" {% if selected_type == "users" %}selected{% endif %}>Users</option>
        <option value="blogs" {% if selected_type == "blogs" %}selected{% endif %}>Blogs</option>
    </select>

    <button class="btn btn-primary" type="submit">Search</button>
</form>
{% endwith %}

{% if trips %}
<section class="section-grid">
    <header class="section-header">
        <h2>{% if has_query %}Trip results{% else %}Top searched trips{% endif %}</h2>
    </header>
    <div class="card-grid">
        {% for trip in trips %}
        {% include "partials/cards/trip_card.html" with trip=trip %}
        {% endfor %}
    </div>
</section>
{% endif %}

{% if profiles %}
<section class="section-grid">
    <header class="section-header">
        <h2>{% if has_query %}User results{% else %}Top searched users{% endif %}</h2>
    </header>
    <div class="card-grid">
        {% for profile in profiles %}
        {% include "partials/cards/user_card.html" with profile=profile %}
        {% endfor %}
    </div>
</section>
{% endif %}

{% if blogs %}
<section class="section-grid">
    <header class="section-header">
        <h2>{% if has_query %}Blog results{% else %}Top searched blogs{% endif %}</h2>
    </header>
    <div class="card-grid">
        {% for blog in blogs %}
        {% include "partials/cards/blog_card.html" with blog=blog %}
        {% endfor %}
    </div>
</section>
{% endif %}

{% if not trips and not profiles and not blogs %}
<div class="empty-state">
    {% if has_query %}
    No results matched your query.
    {% else %}
    No recommendations are available yet. Check back soon for fresh trips, creators, and stories.
    {% endif %}
</div>
{% endif %}
{% endblock %}
