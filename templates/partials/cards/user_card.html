<article class="card card-user" data-card-type="user" data-card-id="{{ profile.id|default:'n/a' }}">
    <header class="card-header">
        <p class="card-kicker">Creator</p>
        <h3 class="card-title">
            {% if profile.username %}
            <a href="/u/{{ profile.username }}/">@{{ profile.username }}</a>
            {% else %}
            @username
            {% endif %}
        </h3>
    </header>
    <p class="card-description">
        {{ profile.bio|default:"This traveler has not added a bio yet."|truncatechars:180 }}
    </p>
    <dl class="card-meta-grid">
        <div>
            <dt>Followers</dt>
            <dd>{{ profile.followers_count|default:"0" }}</dd>
        </div>
        <div>
            <dt>Hosted trips</dt>
            <dd>{{ profile.trips_count|default:"0" }}</dd>
        </div>
    </dl>
    <div class="card-actions">
        <a class="btn btn-secondary" href="{{ profile.url|default:'#' }}">View profile</a>
        {% if user.is_authenticated %}
        {% if profile.username %}
        <form method="post" action="{% url 'social:follow' username=profile.username %}" class="inline-form">
            {% csrf_token %}
            <input type="hidden" name="next" value="{{ request.get_full_path }}">
            <button class="btn btn-primary" type="submit">Follow</button>
        </form>
        <form method="post" action="{% url 'social:bookmark' %}" class="inline-form">
            {% csrf_token %}
            <input type="hidden" name="type" value="user">
            <input type="hidden" name="id" value="{{ profile.username }}">
            <input type="hidden" name="next" value="{{ request.get_full_path }}">
            <button class="btn btn-ghost" type="submit">Bookmark profile</button>
        </form>
        {% if user.username|lower != profile.username|lower %}
        <a class="btn btn-ghost" href="{% url 'interactions:dm-inbox' %}?with={{ profile.username }}">Message</a>
        {% else %}
        <button class="btn btn-ghost" type="button" disabled>Message</button>
        {% endif %}
        {% else %}
        <button class="btn btn-primary" type="button" disabled>Follow</button>
        <button class="btn btn-ghost" type="button" disabled>Bookmark profile</button>
        <button class="btn btn-ghost" type="button" disabled>Message</button>
        {% endif %}
        {% else %}
        <button class="btn btn-primary js-guest-action" type="button" data-action-label="follow this user">Follow</button>
        <button class="btn btn-ghost js-guest-action" type="button" data-action-label="message this user">Message</button>
        <button class="btn btn-ghost js-guest-action" type="button" data-action-label="bookmark this user">Bookmark profile</button>
        {% endif %}
    </div>
</article>
